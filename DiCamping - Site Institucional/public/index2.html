<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DiCamping</title>

  <link rel="icon" href="./img/DICAMPING_LOGOPRETA.png" />
  <link rel="stylesheet" href="./css/index2_style.css" />
  <script src="./js/menu.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
  <header id="home">
    <div id="fundo_header">
      <picture>
        <img src="./img/imgFundo.jpeg" class="fundo" />
      </picture>
    </div>
    <nav>
      <a href="#home">
        <img id="logo" src="./img/DICAMPING_LOGOBRANCA.png" />
      </a>

      <ul id="navbar_lista">
        <li class="navbar-link">
          <a href="#home" class="nav-links">HOME</a>
        </li>
        <li class="navbar-link">
          <a href="#dicas" class="nav-links">DICAS EXTRAS</a>
        </li>
        <li class="navbar-link">
          <a href="#indicacoes" class="nav-links">INDICAÇÕES DE CAMPING</a>
        </li>
        <li class="navbar-link">
          <a href="formTIPO.html" class="nav-links">CAMPING IDEAL?</a>
        </li>
        <li class="navbar-link">
          <a href="#campingIndicado" class="nav-links">CAMPINGS MAIS INDICADOS</a>
        </li>
        <li class="navbar-link">
          <a href="sobre.html" class="nav-links">SOBRE MIM</a>
        </li>
        <li>
          <a href="index.html"><button class="button-login">SAIR</button></a>
        </li>
      </ul>
    </nav>

    <div id="header_slogan">
      <div class="slogan">
        <p>Sinta a <b>paz e a liberdade</b> do acampamento</p>
        <h1>Bem vindo ao nosso conteudo exclusivo!</h1>
        <div class="botao-header">
          <button onclick="openModal()">ACESSE NOSSA IA</button>
        </div>
      </div>
      .
    </div>
  </header>

  <main>
    <section id="dicas">
      <div class="planejamento">
        <div class="conteudo-planejamento">
          <div class="titulo-planejamento">
            <h1>DICAS EXTRAS DE PRESERVAÇÃO A NATUREZA</h1>
            <center>
              <p>"Ser um campista responsável não é apenas sobre desfrutar das maravilhas naturais, mas também
                protegê-las com paixão e vigor. Nossa expedição é mais do que uma aventura; é um compromisso duradouro
                com a preservação ambiental."</p>
            </center>
          </div>

          <div class="cards">
            <div class="card">
              <img src="img/preserve1.svg" alt="">
              <h2>Minimize seu impacto</h2>
              <p>Escolha locais de acampamento já impactados anteriormente, como áreas de solo compacto ou rochoso, para
                evitar danos adicionais à vegetação.
              </p>
            </div>

            <div class="card">
              <img src="img/preserve2.svg" alt="">
              <h2>Não deixe rastro</h2>
              <p>Ao acampar, não deixe marcas visíveis de sua presença. Desmonte sua barraca, recolha todo o lixo
                (incluindo restos de comida) e deixe o local como você o encontrou.</p>
            </div>

            <div class="card">
              <img src="img/preserve3.svg" alt="">
              <h2>Use fogueiras com responsabilidade</h2>
              <p> Em áreas permitidas, faça fogueiras apenas se necessário e com moderação. Use lenha caída no chão e
                certifique-se de apagar completamente a fogueira antes de sair.</p>
            </div>
          </div>

          <div class="cards">
            <div class="card">
              <img src="img/preserve4.svg" alt="">
              <h2>Respeite a fauna e flora</h2>
              <p>Não alimente animais selvagens, não perturbe seus habitats naturais e evite arrancar plantas ou
                danificar a vegetação.</p>
            </div>

            <div class="card">
              <img src="img/preserve5.svg" alt="">
              <h2>Conheça e respeite as regras locais</h2>
              <p>Esteja ciente das regulamentações e restrições do local onde está acampando e siga-as rigorosamente.
              </p>
            </div>

            <div class="card">
              <img src="img/preserve6.svg" alt="">
              <h2>Eduque-se e eduque outros</h2>
              <p>Aprenda mais sobre práticas de mínimo impacto e conscientize outros campistas sobre a importância da
                preservação ambienta. Utilize nossa inteligencia artificial e aprenda mais!</p>
            </div>
          </div>
        </div>
        <br><br><br>
        <div class="cardODS">
          <a href="https://www.iberdrola.com/sustentabilidade/comprometidos-objetivos-desenvolvimento-sustentavel/ods-15-proteger-a-vida-terrestre"
            target="_blank">
            <img src="img/ods3.png">
          </a>

          <a href="https://www.iberdrola.com/sustentabilidade/comprometidos-objetivos-desenvolvimento-sustentavel/ods-3-saude-de-qualidade#:~:text=O%20ODS%203%20visa%20garantir,crianças%20menores%20de%205%20anos."
            target="_blank">
            <img src="img/ods15.jpg">
          </a>
        </div>
      </div>
    </section>

    <section id="indicacoes">
      <div class="container-indicacoes">
        <div class="texto-indicacoes">
          <h1>INDICAÇÕES DE CAMPING</h1>

          <p>
            <center>
              <h3>
                Aventure-se por trilhas e campings inesquecíveis e desfrute da
                beleza da natureza em campings cuidadosamente selecionados por
                mim!
              </h3>
            </center>
            <br />
          </p>

          <div class="image-indicacoes">
            <center>
              <iframe src="https://www.google.com/maps/d/embed?mid=1Pjr6Q-FJU2zrr-XcbkK6acKeBKf9JxU&ehbc=2E312F"
                width="60%" height="600"></iframe>
            </center>
          </div>
          <br /><br />
          <center>
            <h5>
              Nesta seção exclusiva, compartilho com você meus campings,
              lugares e trilhas favoritos, frutos de diversas explorações e
              experiências enriquecedoras. Cada um deles oferece algo único,
              seja por sua localização privilegiada, estrutura completa ou
              atmosfera acolhedora.
            </h5>
          </center>
          <br />
          <br />
        </div>
      </div>

      <div class="card-container">

        <div id="cardC1" class="cardC">
          <img src="img/nhangussu.jpg" alt="Camping Selvagem">
          <h2>PICO DO NHANGUSSU</h2>
        </div>

        <div id="myModal1" class="modalC">
          <div class="modalC-content">
            <span class="close" data-modal="myModal1">&times;</span>
            <img src="img/EUnhangussu.jpg" alt="Camping Selvagem">
            <div class="description">
              <br>
              <h2>TIPO DE CAMPING: SELVAGEM</h2>
              <p>Descrição do Camping: Acampar no Pico do Nhanguçu proporciona uma experiência incrível com vistas
                panorâmicas de Guarulhos, em um ambiente natural e próximo à cidade.</p>
            </div>
          </div>
        </div>


        <div id="cardC2" class="cardC">
          <img src="img/sununga.jpg" alt="Camping Selvagem">
          <h2>PRAIA DA SUNUNGA</h2>
        </div>

        <!-- MOLDAL -->
        <div id="myModal2" class="modalC">
          <div class="modalC-content">
            <span class="close" data-modal="myModal2">&times;</span>
            <img src="img/EUsununga.jpg" alt="Camping Selvagem">
            <div class="description">
              <br>
              <h2>TIPO DE CAMPING: ORGANIZADO</h2>
              <p>Descrição do Camping: O camping organizado na Praia do Sununga oferece uma experiência confortável e
                segura, com infraestrutura completa, incluindo banheiros, chuveiros, e áreas para cozinhar, tudo à
                beira-mar.</p>
            </div>
          </div>
        </div>


        <div id="cardC3" class="cardC">
          <img src="img/barrocao.png" alt="Camping Selvagem">
          <h2>CACHOEIRRA DO BARROCÃO </h2>
        </div>


        <!-- MOLDAL -->
        <div id="myModal3" class="modalC">
          <div class="modalC-content">
            <span class="close" data-modal="myModal3">&times;</span>
            <img src="img/EUbarrocao.jpg" alt="Camping Selvagem">
            <div class="description">
              <br>
              <h2>TIPO DE CAMPING: SELVAGEM</h2>
              <p>Descrição do Camping: A Cachoeira, em Bom Jesus dos Perdões, é um destino natural encantador,
                oferecendo uma experiência revigorante com suas águas cristalinas, ideal para relaxamento e aventura em
                meio à natureza.</p>
            </div>
          </div>
        </div>


        <div id="cardC4" class="cardC">
          <img src="img/prainhabranca.jpg" alt="Camping Selvagem">
          <h2>PRAINHA BRANCA</h2>
        </div>


        <!-- MOLDAL -->
        <div id="myModal4" class="modalC">
          <div class="modalC-content">
            <span class="close" data-modal="myModal4">&times;</span>
            <img src="img/EUprainha.jpg" alt="Camping Selvagem">
            <div class="description">
              <br>
              <h2>TIPO DE CAMPING: ORGANIZADO</h2>
              <p>Descrição do Camping: A Prainha Branca é uma praia isolada em Guarujá, famosa por suas águas
                cristalinas e areias claras. Acesso apenas por trilha ou barco, proporciona um ambiente tranquilo, ideal
                para quem busca um refúgio longe do agito urbano.</p>
            </div>
          </div>
        </div>

        <div id="cardC5" class="cardC">
          <img src="img/nazare.png" alt="Camping Selvagem">
          <h2>NAZARÉ PAULISTA</h2>
        </div>


        <!-- MOLDAL -->
        <div id="myModal5" class="modalC">
          <div class="modalC-content">
            <span class="close" data-modal="myModal5">&times;</span>
            <img src="img/EUnazare.jpg" alt="Camping Selvagem">
            <div class="description">
              <br>
              <h2>TIPO DE CAMPING: SELVAGEM </h2>
              <p>Descrição do Camping: A Represa Atibainha, localizada em Nazaré Paulista, é uma importante fonte de
                abastecimento de água para São Paulo. Além disso, oferece oportunidades de lazer como pesca e passeios
                de barco, em meio a um ambiente natural preservado.</p>
            </div>
          </div>
        </div>

        <div id="cardC6" class="cardC">
          <img src="img/praiaFora.png" alt="Camping Selvagem">
          <h2>PRAIA DO FORA</h2>
        </div>

        <!-- MOLDAL -->
        <div id="myModal6" class="modalC">
          <div class="modalC-content">
            <span class="close" data-modal="myModal6">&times;</span>
            <img src="img/EUfora.jpg" alt="Camping Selvagem">
            <div class="description">
              <br>
              <h2>TIPO DE CAMPING: ORGANIZADO</h2>
              <p>Descrição do Camping: Praia de Fora, em Trindade, oferece um refúgio tranquilo com águas claras. Também
                atrai surfistas devido às ondas mais fortes em alguns pontos, mas os banhistas devem tomar cuidado com
                as correntezas ao entrar no mar.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- KPIS -->
    <section id="campingIndicado">
      <div class="divGrafico">
        <center>
          <h1>TIPOS DE CAMPING'S MAIS INDICADOS</h1>
          <p id="divMediaAcertos"></p>
        </center>
        <BR><BR>
        <div class="grafico_indicados">
          <div>
            <h2>
              <center> CAMPING MAIS INDICADO: </center>
            </h2>
            <spam id="campingMaisSelecionado"> </spam>
          </div>
          <div>
            <h2>
              <center> CAMPING MENOS INDICADO: </center>
            </h2>
            <p id="campingMenosSelecionado"> </p>
          </div>
        </div><br>

        <!-- GRAFICO -->
        <div class="grafico_indicados">
          <div>
            <canvas id="myChartCanvas"></canvas>
          </div>
          <div>
            <br>
            <h4>O site oferece um formulário interativo para ajudar os usuários a descobrir o camping
              ideal com base em suas preferências. As respostas são usadas para gerar uma dashboard,
              destacando os tipos de campings com mais preferencias pelos úsuarios. Esse gráfico revela tendências e
              preferências,
              auxiliando os usuários a fazerem escolhas informadas. A ferramenta não apenas ajuda a descobrir novos
              destinos, mas também promove uma compreensão ampla das preferências dos campistas, e qual o perfil dos
              úsuarios do site.
              Além disso o formulário por trás desse gráfico, traz informações váliosas para quem tem vontade de
              acampar, mas não sabe por onde
              começar. </h4>
            <br>
            <button onclick="irParaForm()">DESCUBRA O SEU CAMPING IDEAL!</button><br><br>
          </div>
        </div>
      </div>

    </section>
  </main>
  <!-- moldal para aparecer o a ia e o resultado da chamada da IA -->
  <div class="circle" onclick="openModal()"><img src="img/assistente-de-robo.png"></div>
  <div id="modal">
    <div id="modal-content">
      <button class="close-button" onclick="closeModal()">X</button>
      <h1>DiCamping IA</h1>
      <textarea id="pergunta" type="text" placeholder="Digite a sua pergunta..."></textarea>
      <br /><br />
      <button onclick="gerarResposta()">Gerar Resposta</button>
      <h3>Resposta da IA:</h3>
      <div id="resposta"></div>
    </div>
  </div>
  <br /><br /><br /><br />
  </main>
</body>

<footer>
  <p>
    Feito por uma aluna SPTECH <br />
    Yasmim 1º ADS - C <br />
    &copy; 2024
  </p>
</footer>

</html>

<script>
  // MOLDAL DOS CAMPING'S QUE JÁ FUI
  // Aguarda o carregamento completo do conteúdo da página HTML
  document.addEventListener("DOMContentLoaded", function () {
    // Seleciona todos os elementos com a classe "modalC" 
    var modals = document.querySelectorAll(".modalC");

    // Seleciona todos os elementos com a classe "cardC" 
    var cards = document.querySelectorAll(".cardC");

    // Seleciona todos os elementos com a classe "close" 
    var spans = document.querySelectorAll(".close");

    // Para cada cartão, adiciona um evento de clique que abre o modal correspondente
    cards.forEach((card, index) => {
      card.addEventListener("click", function () {
        // Obtém o modal correspondente ao cartão clicado com base no índice (index + 1)
        var modal = document.getElementById("myModal" + (index + 1));
        // Exibe o modal
        modal.style.display = "block";
      });
    });

    // Para cada botão de fechar, adiciona um evento de clique que fecha o modal
    spans.forEach((span) => {
      span.addEventListener("click", function () {
        // Obtém o ID do modal a partir do atributo "data-modal" do botão de fechar
        var modalId = span.getAttribute("data-modal");
        // Seleciona o modal pelo ID
        var modal = document.getElementById(modalId);
        // Esconde o modal
        modal.style.display = "none";
      });
    });
  });
</script>

<script>
  function irParaForm() {
    window.location.href = "formTIPO.html"
  }
</script>



<script>
  // MOLDAL DA IA
    // Função para abrir o modal
    function openModal() {
        // Define o estilo display do modal como "block" para exibi-lo
        document.getElementById("modal").style.display = "block";
    }

    // Função para fechar o modal
    function closeModal() {
        // Define o estilo display do modal como "none" para escondê-lo
        document.getElementById("modal").style.display = "none";
    }

    // Adiciona um evento de clique à janela
    window.onclick = function (event) {
        // Seleciona o modal
        const modal = document.getElementById("modal");
        // Verifica se o alvo do clique é o modal (ou seja, um clique fora do conteúdo do modal)
        if (event.target === modal) {
            // Fecha o modal
            closeModal();
        }
    };
</script>


<script>
  // CHAMADA DA I.A
  async function gerarResposta() {
    const pergunta = document.getElementById("pergunta").value;

    const response = await fetch("http://localhost:3333/perguntar", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ pergunta }),
    });

    const data = await response.json();

    resposta.style.display = "block";
    document.getElementById("resposta").innerText = data.resultado;
  }
</script>

<script>
  // KPI DO CAMPING MAIS SELECIONADO
  async function tipoMaisSelecionado() {
    try {
      const response = await fetch('/camping/tipoMaisSelecionado', { cache: 'no-store' });
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      const data = await response.json();

      // Verifica se a resposta contém dados válidos
      if (Array.isArray(data) && data.length > 0 && data[0].tipo_camping) {
        const tipoCampingMaisSelecionado = data[0].tipo_camping;
        document.getElementById('campingMaisSelecionado').innerText = tipoCampingMaisSelecionado;
      } else {
        throw new Error('Dados inválidos recebidos da API');
      }
    } catch (error) {
      console.error('Erro ao buscar o tipo de camping mais indicado:', error);
      document.getElementById('campingMaisSelecionado').innerText = 'Erro ao carregar os dados';
    }
  }

  document.addEventListener('DOMContentLoaded', tipoMaisSelecionado);

</script>

<script>
    // KPI DO CAMPING MAIS SELECIONADO
  async function tipoMenosSelecionado() {
    try {
      const response = await fetch('/camping/tipoMenosSelecionado', { cache: 'no-store' });
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      const data = await response.json();

      // Verifica se a resposta contém dados válidos
      if (Array.isArray(data) && data.length > 0 && data[0].tipo_camping) {
        const campingMenosSelecionado = data[0].tipo_camping;
        document.getElementById('campingMenosSelecionado').innerText = campingMenosSelecionado;
      } else {
        throw new Error('Dados inválidos recebidos da API');
      }
    } catch (error) {
      console.error('Erro ao buscar o tipo de camping menos indicado:', error);
      document.getElementById('campingMenosSelecionado').innerText = 'Erro ao carregar os dados';
    }
  }
  document.addEventListener('DOMContentLoaded', tipoMenosSelecionado);
</script>


<script>
  let proximaAtualizacao;
  window.onload = function () {
    obterDadosGrafico()
  };
  function obterDadosGrafico() {
    if (proximaAtualizacao != undefined) {
      clearTimeout(proximaAtualizacao);
    }
    fetch(`/camping/grafico`, { cache: 'no-store' }).then(function (response) {
      if (response.ok) {
        response.json().then(function (resposta) {
          console.log(`Dados recebidos: ${JSON.stringify(resposta)}`);
          resposta.reverse();

          plotarGrafico(resposta);

        });
      } else {
        console.error('Nenhum dado encontrado ou erro na API');
      }
    })
      .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
      });
  }


  function plotarGrafico(resposta) {

    console.log('iniciando plotagem do gráfico...');

    // Criando estrutura para plotar gráfico - labels
    let labels = [];

    // Criando estrutura para plotar gráfico - dados
    let dados = {
      labels: labels,
      datasets: [{
        label: 'Quantidade Indicação',
        data: [],
        fill: false,
        backgroundColor: [
          'rgb(255, 98, 0)',
          'rgb(0, 55, 94)',
          'rgb(0, 128, 128)'
        ],
        borderColor: 'rgb(75, 192, 192)',
        tension: 0.1
      }]
    };

    console.log('----------------------------------------------')
    console.log('Estes dados foram recebidos pela funcao "obterDadosGrafico" e passados para "plotarGrafico":')
    console.log(resposta)

    // Inserindo valores recebidos em estrutura para plotar o gráfico
    for (i = 0; i < resposta.length; i++) {
      var registro = resposta[i];
      labels.push(registro.tipo_camping);
      dados.datasets[0].data.push(registro.quantidade);
    }

    console.log('----------------------------------------------')
    console.log('O gráfico será plotado com os respectivos valores:')
    console.log('Labels:')
    console.log(labels)
    console.log('Dados:')
    console.log(dados.datasets)
    console.log('----------------------------------------------')

    // Criando estrutura para plotar gráfico - config
    const config = {
      type: 'bar',
      data: dados,
      responsive: true,
      options: {
        responsive: true,
        scales: {
          y: {
            beginAtZero: true
          }
        },
        plugins: {
          legend: {
            display: false
          }
        }
      }
    };

    // Adicionando gráfico criado em div na tela
    let myChart = new Chart(
      document.getElementById(`myChartCanvas`),
      config
    );

    setTimeout(() => atualizarGrafico(dados, myChart), 2000);
  }
  function atualizarGrafico(dados, myChart) {

    fetch(`/camping/tempo-real`, { cache: 'no-store' }).then(function (response) {
      if (response.ok) {
        response.json().then(function (novoRegistro) {


          // alertar(novoRegistro, idAquario);
          console.log(`Dados recebidos: ${JSON.stringify(novoRegistro)}`);
          console.log(`Dados atuais do gráfico:`);
          console.log(dados);


          if (novoRegistro[0].tipo_camping == dados.labels[dados.labels.length - 1]) {
            console.log("---------------------------------------------------------------")
            console.log("Como não há dados novos para captura, o gráfico não atualizará.")

            console.log("Horário do novo dado capturado:")
            console.log(novoRegistro[0].faixa)
            console.log("Horário do último dado capturado:")
            console.log(dados.labels[dados.labels.length - 1])
            console.log("---------------------------------------------------------------")
          } else {
            // tirando e colocando valores no gráfico
            dados.labels.shift(); // apagar o primeiro
            dados.labels.push(novoRegistro[0].tipo_camping); // incluir um novo momento

            dados.datasets[0].data.shift();  // apagar o primeiro de umidade
            dados.datasets[0].data.push(novoRegistro[0].quantidade); // incluir uma nova medida de umidade



            myChart.update();
          }

          // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
          proximaAtualizacao = setTimeout(() => atualizarGrafico(dados, myChart), 2000);
        });
      } else {
        console.error('Nenhum dado encontrado ou erro na API');
        // Altere aqui o valor em ms se quiser que o gráfico atualize mais rápido ou mais devagar
        proximaAtualizacao = setTimeout(() => atualizarGrafico(dados, myChart), 2000);
      }
    })
      .catch(function (error) {
        console.error(`Erro na obtenção dos dados p/ gráfico: ${error.message}`);
      });

  }
</script>